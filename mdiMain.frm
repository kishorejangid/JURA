VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.MDIForm mdiMain 
   AutoShowChildren=   0   'False
   BackColor       =   &H8000000C&
   Caption         =   "JURA"
   ClientHeight    =   8610
   ClientLeft      =   225
   ClientTop       =   555
   ClientWidth     =   14055
   Enabled         =   0   'False
   Icon            =   "mdiMain.frx":0000
   StartUpPosition =   3  'Windows Default
   WindowState     =   2  'Maximized
   Begin JURA.Ribbon Ribbon 
      Align           =   1  'Align Top
      Height          =   1740
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   14055
      _ExtentX        =   24791
      _ExtentY        =   3069
      BackColor       =   4210752
      ForeColor       =   -2147483630
   End
   Begin MSComctlLib.ImageList ImageList 
      Left            =   0
      Top             =   2520
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   32
      ImageHeight     =   32
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   59
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":57E2
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":5F5C
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":6836
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":79C8
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":ACAA
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":B584
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":BE5E
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":C738
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":D012
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":D8EC
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":E1C6
            Key             =   ""
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":114A8
            Key             =   ""
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":11C22
            Key             =   ""
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1239C
            Key             =   ""
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":12B16
            Key             =   ""
         EndProperty
         BeginProperty ListImage16 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":13290
            Key             =   ""
         EndProperty
         BeginProperty ListImage17 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":13A0A
            Key             =   ""
         EndProperty
         BeginProperty ListImage18 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":14184
            Key             =   ""
         EndProperty
         BeginProperty ListImage19 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":148FE
            Key             =   ""
         EndProperty
         BeginProperty ListImage20 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":15078
            Key             =   ""
         EndProperty
         BeginProperty ListImage21 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":157F2
            Key             =   ""
         EndProperty
         BeginProperty ListImage22 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":15F6C
            Key             =   ""
         EndProperty
         BeginProperty ListImage23 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":166E6
            Key             =   ""
         EndProperty
         BeginProperty ListImage24 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":16E60
            Key             =   ""
         EndProperty
         BeginProperty ListImage25 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":175DA
            Key             =   ""
         EndProperty
         BeginProperty ListImage26 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":17D54
            Key             =   ""
         EndProperty
         BeginProperty ListImage27 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":184CE
            Key             =   ""
         EndProperty
         BeginProperty ListImage28 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":18C48
            Key             =   ""
         EndProperty
         BeginProperty ListImage29 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":193C2
            Key             =   ""
         EndProperty
         BeginProperty ListImage30 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":19B3C
            Key             =   ""
         EndProperty
         BeginProperty ListImage31 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1A2B6
            Key             =   ""
         EndProperty
         BeginProperty ListImage32 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1AA30
            Key             =   ""
         EndProperty
         BeginProperty ListImage33 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1B1AA
            Key             =   ""
         EndProperty
         BeginProperty ListImage34 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1B924
            Key             =   ""
         EndProperty
         BeginProperty ListImage35 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1C09E
            Key             =   ""
         EndProperty
         BeginProperty ListImage36 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1C818
            Key             =   ""
         EndProperty
         BeginProperty ListImage37 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1CF92
            Key             =   ""
         EndProperty
         BeginProperty ListImage38 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1D70C
            Key             =   ""
         EndProperty
         BeginProperty ListImage39 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1DE86
            Key             =   ""
         EndProperty
         BeginProperty ListImage40 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1E600
            Key             =   ""
         EndProperty
         BeginProperty ListImage41 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1ED7A
            Key             =   ""
         EndProperty
         BeginProperty ListImage42 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1F4F4
            Key             =   ""
         EndProperty
         BeginProperty ListImage43 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":1FC6E
            Key             =   ""
         EndProperty
         BeginProperty ListImage44 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":203E8
            Key             =   ""
         EndProperty
         BeginProperty ListImage45 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":20B62
            Key             =   ""
         EndProperty
         BeginProperty ListImage46 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":212DC
            Key             =   ""
         EndProperty
         BeginProperty ListImage47 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":21A56
            Key             =   ""
         EndProperty
         BeginProperty ListImage48 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":221D0
            Key             =   ""
         EndProperty
         BeginProperty ListImage49 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":2294A
            Key             =   ""
         EndProperty
         BeginProperty ListImage50 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":230C4
            Key             =   ""
         EndProperty
         BeginProperty ListImage51 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":2383E
            Key             =   ""
         EndProperty
         BeginProperty ListImage52 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":23FB8
            Key             =   ""
         EndProperty
         BeginProperty ListImage53 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":24732
            Key             =   ""
         EndProperty
         BeginProperty ListImage54 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":24EAC
            Key             =   ""
         EndProperty
         BeginProperty ListImage55 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":25626
            Key             =   ""
         EndProperty
         BeginProperty ListImage56 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":25DA0
            Key             =   ""
         EndProperty
         BeginProperty ListImage57 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":2651A
            Key             =   ""
         EndProperty
         BeginProperty ListImage58 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":26C94
            Key             =   ""
         EndProperty
         BeginProperty ListImage59 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "mdiMain.frx":2740E
            Key             =   ""
         EndProperty
      EndProperty
   End
End
Attribute VB_Name = "mdiMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'Project Name:              JURA
'Project Guide:             Caroline V S Mary Madam
'Project Author:            H.Kishore Kumar
'Project Started On:        15-06-09
'Current Version Stated On: 23-09-09
'Current Version:           1.0.0.65
'Latest Updates:            Office 2007 Like Ribbon
                           'Reporting
                           'Mailing Reports
                           'PDF Report Creation
'List Of Forms:            'mdiMain
                           'frmContact
                           'frmDBPass
                           'frmEmail
                           'frmEmailSetting
                           'frmEnterMarks
                           'frmLogin
                           'frmMarks
                           'frmMarksStaff
                           'frmNewStud
                           'frmNewSubject
                           'frmNewUser
                           'frmReport
                           'frmSyllabus
                           'frmToday
'Modules Used:             'DataBaseConnection
                           'General  Contains Sub Main and SubRoutines for Creating Table
'External Classes Used:    'c32bppDIB   Used By StylerButton Control
                           'cBMPparser  Used By StylerButton Control For Parsing Bitmap Images
                           'cGIFparser  Used By StylerButton Control For Parsing GIF Images
                           'cICOparser  Used By StylerButton Control For Parsing Icon Images
                           'cPNGparser  Used By StylerButton Control For Parsing PNG Images
                           'transperant Used By frmSplash for form transperancy
                           'clsPDF      Create a PDF File
'External Modules Used:    'modParsers  Used By StylerButtonControl
                           'SysInfo     Gets System Information
'Print Date:      07-10-2009
'Retouch started on: 26.7.10

Option Explicit
Dim Theme As Integer
Public User As String

Private Sub btnClose_Click()
    End
End Sub

Private Sub MDIForm_Load()
        
    'Dim l As Long
    
    'l = GetWindowLong(Me.hWnd, GWL_STYLE)
    'l = l And Not (WS_MINIMIZEBOX)
    'l = l And Not (WS_MAXIMIZEBOX)
    'l = l Xor WS_CAPTION
    'l = SetWindowLong(Me.hWnd, GWL_STYLE, l)
    
    Me.Width = Screen.Width * 0.85
    Me.Height = Screen.Height * 0.75
           
    Theme = GetSetting(App.CompanyName, "Theme", "Change", 0)
    Ribbon.Theme = Theme 'Set Theme
    mdiMain.Picture = Ribbon.LoadBackground
    mdiMain.BackColor = Ribbon.BackColor
    Ribbon.ImageList = ImageList
    Ribbon.ButtonCenter = True
        
    
    Ribbon.AddTab "T1", "Student's Area"
    Ribbon.AddTab "T2", "Faculty's Area"
    Ribbon.AddTab "T3", "Master Entry"
    Ribbon.AddTab "T4", "Administrator"
    Ribbon.AddTab "T5", "Software Help"
    
    
    
    Ribbon.AddCat "1C1", "T1", "Results Of Student", False
    Ribbon.AddCat "1C3", "T1", "Contact Information", False
    Ribbon.AddCat "1C4", "T1", "Academic Syllabus", False
    Ribbon.AddCat "1C5", "T1", "Email Marks Sheet", False
    Ribbon.AddCat "1C6", "T1", "Change Your Password", False
    

    Ribbon.AddCat "2C1", "T2", "Result Report", False
    Ribbon.AddCat "2C2", "T2", "Email Report", False
    Ribbon.AddCat "2C3", "T2", "Change Your Password", False
    
    Ribbon.AddCat "3C1", "T3", "Insert New Student", False
    Ribbon.AddCat "3C2", "T3", "Insert New Subject", False
    Ribbon.AddCat "3C3", "T3", "Insert Student Marks", False
    Ribbon.AddCat "3C4", "T3", "Download Results", False
    
    Ribbon.AddCat "4C1", "T4", "Change DataBase Settings", False
    Ribbon.AddCat "4C2", "T4", "Manage Software Users", False
    Ribbon.AddCat "4C3", "T4", "Application Settings", False
    
    Ribbon.AddCat "5C1", "T5", "Change Software Theme", False
    Ribbon.AddCat "5C2", "T5", "Form Color", False
    Ribbon.AddCat "5C3", "T5", "System Information", False
    
    Ribbon.AddButton "1B1", "1C1", "          &Marks          ", "3", False, "Click To See Your Marks"
    Ribbon.AddButton "1B3", "1C3", "          Contact          ", "17", False, "Click to Update your Contact Information"
    Ribbon.AddButton "1B4", "1C4", "          Syllabus          ", "16", False, "Click to view Syllabus"
    Ribbon.AddButton "1B5", "1C5", "          Email          ", "9", False, "Click to Mail Marks Sheet"
    Ribbon.AddButton "1B6", "1C6", "     Change Password     ", "44", False, "Click to Change your Password"
    
    Ribbon.AddButton "2B1", "2C1", "   Semester Report   ", "48", False, "Click to View Report"
    Ribbon.AddButton "2B4", "2C1", "  Subject Report  ", "48", False, "Click to View Report"
    Ribbon.AddButton "2B5", "2C1", "  Subject Analysis  ", "48", False, "Click to View Report"
    Ribbon.AddButton "2B6", "2C1", "  Class Report  ", "48", False, "Click to View Report"
    Ribbon.AddButton "2B2", "2C2", "          Email          ", "9", False, "Click to Mail Report"
    Ribbon.AddButton "2B3", "2C3", "     Change Password     ", "44", False, "Click to Change your Password"
    
    Ribbon.AddButton "3B1", "3C1", "         Student         ", "24", False, "Click to Insert New Student"
    Ribbon.AddButton "3B2", "3C2", "         Subject         ", "5", False, "Click to Insert New Subject"
    Ribbon.AddButton "3B3", "3C3", "         Marks           ", "5", False, "Click to Insert Student Marks"
    Ribbon.AddButton "3B4", "3C4", "       Download        ", "6", False, "Click to Download Results"
    
    Ribbon.AddButton "4B1", "4C1", "             Settings             ", "30", False, "Click to Change DataBase Setting"
    Ribbon.AddButton "4B2", "4C2", "   Create User  ", "24", False, "Click to Create New User"
    Ribbon.AddButton "4B3", "4C2", "   Delete User  ", "25", False, "Click to Delete User"
    Ribbon.AddButton "4B4", "4C3", "       Application Settings        ", "30", False, "Click to Change Application Setting"
    
    Ribbon.AddButton "5B1", "5C1", "            Theme            ", "52", False, "Click to Change the Theme"
    Ribbon.AddButton "5B2", "5C2", "     Form Color     ", "52", False, "Click to Change the Form Color"
    Ribbon.AddButton "5B3", "5C3", "       Sys Info       ", "21", False, "Click To See System Info"
    Ribbon.Refresh
End Sub

Private Sub MDIForm_Resize()
    On Error Resume Next
    Me.Left = (Screen.Width - Me.Width) / 2
    Me.Top = Screen.Height * 0.1
End Sub

Private Sub MDIForm_Unload(Cancel As Integer)
    conn.Close
    Set conn = Nothing
    Dim strTheme(1 To 7) As String
    strTheme(1) = "Orange"
    strTheme(2) = "Blue"
    strTheme(3) = "Black"
    strTheme(4) = "Violet"
    strTheme(5) = "Cyan"
    strTheme(6) = "Brown"
    strTheme(7) = "Green"
    
    If flgRandomTheme = True Then
        
    End If
End Sub

Private Sub Ribbon_TabClick(ByVal ID As String, ByVal Caption As String)
If ID = "T4" Then
    If admCheck <> "Administrator" Then
        MsgBox "Administrator Area Is Not Allowed For Other Users", vbInformation, "User Error"
        End
    End If
ElseIf ID = "T2" Then
        If admCheck <> "Administrator" And admCheck <> "Staff" Then
            MsgBox "Student Are Not Allowed Here"
            End
        End If
ElseIf ID = "T3" Then
        If admCheck <> "Administrator" And admCheck <> "Staff" Then
            MsgBox "Student Are Not Allowed Here"
            End
        End If
End If
        
End Sub

Private Sub Ribbon_ButtonClick(ByVal ID As String, ByVal Caption As String)
    If ID = "1B1" Then
        frmMarks.Show
    ElseIf ID = "1B3" Then
        frmContact.Show
    ElseIf ID = "1B4" Then
        frmSyllabus.Show
    ElseIf ID = "1B5" Then
        frmEmail.Show
    ElseIf ID = "1B6" Then
        frmNewUser.Show
        frmNewUser.cmdDelete.Visible = False
        frmNewUser.cmdCreate.Visible = False
        frmNewUser.cmdChange.Visible = True
        frmNewUser.cmbUserType.Text = admCheck
        frmNewUser.cmbUserType.Enabled = False
        frmNewUser.txtUserID.Text = userCheck
        frmNewUser.txtUserID.Enabled = False
    ElseIf ID = "2B1" Then
        frmReport.Show
    ElseIf ID = "2B2" Then
        frmEmail.Show
    ElseIf ID = "2B3" Then
        frmNewUser.Show
        frmNewUser.cmdDelete.Visible = False
        frmNewUser.cmdCreate.Visible = False
        frmNewUser.cmdChange.Visible = True
        frmNewUser.cmbUserType.Text = admCheck
        frmNewUser.cmbUserType.Enabled = False
        frmNewUser.txtUserID.Text = userCheck
        frmNewUser.txtUserID.Enabled = False
    ElseIf ID = "2B4" Then
        frmSubjFailReport.Show
    ElseIf ID = "2B5" Then
        frmSubjectAnalysis.Show
    ElseIf ID = "2B6" Then
        frmClass.Show
    ElseIf ID = "3B1" Then
        frmNewStud.Show
    ElseIf ID = "3B2" Then
        frmNewSubject.Show
    ElseIf ID = "3B3" Then
        frmEnterMarks.Show
    ElseIf ID = "3B4" Then
        frmDownloadResults.Show
    ElseIf ID = "4B1" Then
        frmDBPass.Show
    ElseIf ID = "4B2" Then
        frmNewUser.Show
        frmNewUser.cmdCreate.Visible = True
        frmNewUser.cmdDelete.Visible = False
        frmNewUser.cmdChange.Visible = False
    ElseIf ID = "4B3" Then
        frmNewUser.Show
        frmNewUser.cmdDelete.Visible = True
        frmNewUser.cmdCreate.Visible = False
        frmNewUser.cmdChange.Visible = False
    ElseIf ID = "4B4" Then
        frmSettings.Show
    ElseIf ID = "5B1" Then
        Theme = Theme + 1
        If Theme = 3 Then Theme = 0
        Ribbon.Theme = Theme
        Ribbon.Refresh
        mdiMain.Picture = Ribbon.LoadBackground
        mdiMain.BackColor = Ribbon.BackColor
        SaveSetting App.CompanyName, "Theme", "Change", Theme
    ElseIf ID = "5B2" Then
        frmTheme.Show
    ElseIf ID = "5B3" Then
        Call StartSysInfo
    End If
End Sub
